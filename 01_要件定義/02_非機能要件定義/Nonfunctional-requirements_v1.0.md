# HarmoNet 非機能要件定義書（NFR）_v1.0

## 1. 目的

本書は HarmoNet システム全体に適用される **非機能要件（NFR）** を定義する。システム品質、運用性、保守性、安全性、可用性など、
機能要件では表現できない横断的要件を明確化することで、基本設計・詳細設計・実装および運用全体の基準とする。

---

## 2. 適用範囲

本書は HarmoNet の全コンポーネントおよび全サービスに適用する。

* フロントエンド（Next.js / Vercel）
* バックエンド（Supabase）
* 認証方式（MagicLink）
* ストレージ・DB・多言語化
* 運用・保守

---

## 3. システム品質要件

### 3.1 可用性

* 本システムは個人開発プロジェクトであり、**24/365 稼働保証は求めない**。
* Vercel および Supabase の提供するサービス可用性に依存する。
* 障害発生時は手動で復旧し、即時復旧は必須としない。

### 3.2 性能（パフォーマンス）

* 初期表示：3 秒以内（MVP 目標）
* 再訪表示：1.5 秒以内
* 認証処理：2 秒以内（MagicLink）
* DB クエリ：1 秒以内
* 同時アクセス：100 ユーザー規模を想定（初期段階）

### 3.3 拡張性（スケーラビリティ）

* 初期は Supabase Free/Pro + Vercel Hobby で運用可能とする。
* 利用状況に応じて Supabase Pro / Vercel Pro へ段階的に引き上げる。
* Redis 等の追加ミドルウェアは初期要件に含めず、必要時に導入検討する。

---

## 4. セキュリティ要件（非機能）

※ 認証方式の詳細仕様は個別ドキュメントに分離し、本章ではシステム横断の抽象要件のみ扱う。

### 4.1 データ保護

* 全通信は HTTPS（TLS1.2+）を必須とする。
* 機密情報は環境変数で管理し、Git 管理下に置かない。
* 将来的に個人情報（氏名・住所等）を扱う場合は暗号化方式（AES 等）を再検討する。

### 4.2 アクセス制御

* Supabase の RLS（Row Level Security）によりテナント分離を行う。
* すべての業務テーブルに `tenant_id` を保持する。

### 4.3 認証方式（概要）

* HarmoNet は **完全パスワードレス方式** を採用する。

  * MagicLink（メール認証）
* 認証方式の個別仕様は adoption-summary にて定義し、本要件書では方式選択の方針のみ記載する。

---

## 5. 運用・保守要件

### 5.1 ログ

* ログの目的は **障害解析と運用確認** に限定する。
* ログの出力先は Vercel / Supabase の標準ログに依存し、外部ログサービスは利用しない。
* ログフォーマット・詳細項目はログ設計書で別途定義する。
* 認証方式固有のログキーは詳細設計で定義し、本書では記載しない。

### 5.2 バックアップ

* Supabase の自動スナップショット機能に依存する。
* 必要に応じて手動バックアップを取得する。
* リストア手順は運用フローにて定義する。

### 5.3 障害対応

* 商用 SLA は要求しない。
* 障害検知は画面・レスポンス異常による手動発見を前提とする。
* 復旧は Supabase / Vercel の管理画面から実施する。

### 5.4 デプロイ

* CI/CD は必須としない。
* 手動デプロイ（Vercel ダッシュボード）を基本とする。

---

## 6. アクセシビリティ要件

* WCAG 2.2 Level AA 相当を目標とする。
* コントラスト比 4.5:1 以上を維持する。
* キーボード操作で主要機能が利用可能であること。
* i18n（日本語・英語・中国語）対応を必須とする。

---

## 7. 外部サービス依存ポリシー

* 外部 API の仕様変更に対して、HarmoNet 内の構造が影響を受けないように抽象化する。

---

## 8. 非機能要件として扱わないもの

* 個別認証方式の詳細仕様（MagicLink）
* 特定 API 名・ログキー・SDK メソッド名（実装依存）
* UI レベルの詳細（詳細設計で扱う）

※ これらは必ず adoption-summary（方式選定資料）または詳細設計書に記載する。

---

## 9. 位置付け

本 NFR は HarmoNet の **全体品質要件の基準** を定める文書であり、
基本設計、詳細設計の上位に位置する。


---
