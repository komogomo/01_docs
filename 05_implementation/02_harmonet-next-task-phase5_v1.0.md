# HarmoNet Phase 5: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹ç¯‰ ä½œæ¥­æŒ‡ç¤ºæ›¸

**ä½œæˆæ—¥**: 2025å¹´11æœˆ04æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v1.0  
**å¯¾è±¡Phase**: Phase 5  
**å‰ææ¡ä»¶**: Phase 1-4å®Œäº†æ¸ˆã¿

---

## ğŸ¯ æ¬¡å›ãƒãƒ£ãƒƒãƒˆé–‹å§‹æ™‚ã®ä¼é”æ–‡

```
HarmoNeté–‹ç™ºã®ç¶šãã§ã™ã€‚
Phase 1-4å®Œäº†æ¸ˆã¿ï¼ˆSupabaseç’°å¢ƒæ§‹ç¯‰å®Œäº†ï¼‰ã€‚

æ¬¡ã¯Phase 5: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹ç¯‰ã‚’é–‹å§‹ã—ã¾ã™ã€‚
ä½œæ¥­æŒ‡ç¤ºæ›¸: 02_harmonet-next-task-phase5_v1.0.md ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
```

---

## ğŸ“Š å‰å›ã¾ã§ã®å®Œäº†çŠ¶æ³

### âœ… Phase 1-4å®Œäº†æ¸ˆã¿

| Phase | å†…å®¹ | çŠ¶æ…‹ |
|-------|------|------|
| Phase 1 | åŸºç›¤ãƒ„ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« | âœ… å®Œäº† |
| Phase 2 | é–‹ç™ºç’°å¢ƒæ§‹ç¯‰ | âœ… å®Œäº† |
| Phase 3 | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæº–å‚™ | âœ… å®Œäº† |
| Phase 4 | Supabaseç’°å¢ƒæ§‹ç¯‰ | âœ… å®Œäº† |

### ğŸ”— ç¾åœ¨ã®ç’°å¢ƒæƒ…å ±

```
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: D:\projects\HarmoNet
Supabase Studio URL: http://127.0.0.1:54323
Supabase API URL: http://127.0.0.1:54321
Database URL: postgresql://postgres:postgres@127.0.0.1:54322/postgres
```

### ğŸ“ å‚ç…§ãƒ•ã‚¡ã‚¤ãƒ«

- **ä½œæ¥­è¨˜éŒ²**: `01_harmonet-supabase-setup-log_v1.0.md`
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒŠãƒ¬ãƒƒã‚¸**: `/mnt/project/` é…ä¸‹ã®å„ç¨®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

---

## ğŸ¯ Phase 5: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹ç¯‰

### ä½œæ¥­ç›®æ¨™

HarmoNetã‚·ã‚¹ãƒ†ãƒ ã®åŸºç›¤ã¨ãªã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã‚’è¨­è¨ˆãƒ»å®Ÿè£…ã™ã‚‹ã€‚

### ä¸»è¦æˆæœç‰©

1. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆæ›¸**
   - ERå›³
   - ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©æ›¸
   - ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©

2. **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«**
   - åŸºæœ¬ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆSQL
   - ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å®šç¾©
   - åˆ¶ç´„æ¡ä»¶

3. **Row Level Security (RLS) è¨­å®š**
   - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼å®šç¾©

---

## ğŸ“‹ Phase 5 è©³ç´°ä½œæ¥­æ‰‹é †

### Step 5-1: äº‹å‰ç¢ºèªã€æ‰€è¦æ™‚é–“: 5åˆ†ã€‘

#### ç¢ºèªé …ç›®

1. **Supabaseç’°å¢ƒã®èµ·å‹•ç¢ºèª**
   ```bash
   cd D:\projects\HarmoNet
   docker ps
   npx supabase status
   ```

   **æœŸå¾…çµæœ**:
   - 12å€‹ã®ã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ä¸­
   - `Started supabase local development setup is running.`

2. **Studioå‹•ä½œç¢ºèª**
   - ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://127.0.0.1:54323` ã‚’é–‹ã
   - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

3. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒŠãƒ¬ãƒƒã‚¸ã®ç¢ºèª**
   - æ©Ÿèƒ½è¦ä»¶ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç¢ºèª
   - ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆã«é–¢é€£ã™ã‚‹ä»•æ§˜ã®æ´—ã„å‡ºã—

#### ç’°å¢ƒãŒåœæ­¢ã—ã¦ã„ã‚‹å ´åˆ

```bash
cd D:\projects\HarmoNet
npx supabase start
```

---

### Step 5-2: è¦ä»¶å®šç¾©ã®ç¢ºèªã€æ‰€è¦æ™‚é–“: 30åˆ†ã€‘

#### ä½œæ¥­å†…å®¹

1. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒŠãƒ¬ãƒƒã‚¸ã®ç²¾èª­**
   
   ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç¢ºèªï¼š
   - `HarmoNet_Functional_Requirements_v1_3_merged_for_Claude.md`
   - `harmonet-tenant-config-schema_v1_1.md`
   - `tenant-config-part01_common-attributes_v1_1.md`
   - `tenant-config-part02_roles-and-permissions_v1_1.md`
   - `tenant-config-part03_login-settings_v1_1.md`
   - `tenant-config-part04_home-screen_v1_2.md`

2. **å¿…è¦ãªã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®æ´—ã„å‡ºã—**
   
   æƒ³å®šã•ã‚Œã‚‹ä¸»è¦ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ï¼š
   - ãƒ†ãƒŠãƒ³ãƒˆï¼ˆTenantï¼‰
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆUserï¼‰
   - ãƒ­ãƒ¼ãƒ«ï¼ˆRoleï¼‰
   - æ¨©é™ï¼ˆPermissionï¼‰
   - ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆMenuï¼‰
   - ç”»é¢ï¼ˆScreenï¼‰
   - ãã®ä»–ï¼ˆè¦ä»¶ã«å¿œã˜ã¦è¿½åŠ ï¼‰

3. **ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ã®ä½œæˆ**
   
   å„ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«å¯¾ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’æ±ºå®šï¼š
   - å‘½åè¦å‰‡: ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ï¼ˆä¾‹: `tenant_configs`, `user_roles`ï¼‰
   - è¤‡æ•°å½¢ã‚’ä½¿ç”¨

#### æˆæœç‰©

- ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ï¼ˆMarkdownå½¢å¼ï¼‰
- ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£é–“ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ¦‚è¦

---

### Step 5-3: ERå›³ä½œæˆã€æ‰€è¦æ™‚é–“: 1æ™‚é–“ã€‘

#### ä½œæ¥­å†…å®¹

1. **ä¸»è¦ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©**
   
   ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—ã®ç¨®é¡ï¼š
   - 1å¯¾å¤šï¼ˆ1:Nï¼‰
   - å¤šå¯¾å¤šï¼ˆN:Mï¼‰â€»ä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«å¿…è¦
   - 1å¯¾1ï¼ˆ1:1ï¼‰

2. **ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£ã®æ±ºå®š**
   
   - å¿…é ˆï¼ˆNOT NULLï¼‰
   - ä»»æ„ï¼ˆNULLè¨±å®¹ï¼‰

3. **ERå›³ã®ä½œæˆ**
   
   æ¨å¥¨ãƒ„ãƒ¼ãƒ«ï¼š
   - draw.io
   - Mermaidï¼ˆMarkdownåŸ‹ã‚è¾¼ã¿ï¼‰
   - Supabase Studioï¼ˆç°¡æ˜“çš„ï¼‰

#### Mermaidè¨˜æ³•ä¾‹

```mermaid
erDiagram
    TENANT ||--o{ USER : has
    USER ||--o{ USER_ROLE : has
    ROLE ||--o{ USER_ROLE : assigned
    ROLE ||--o{ ROLE_PERMISSION : has
    PERMISSION ||--o{ ROLE_PERMISSION : granted
```

#### æˆæœç‰©

- ERå›³ï¼ˆPNGå½¢å¼ã¾ãŸã¯Mermaidå½¢å¼ï¼‰
- ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©æ›¸

---

### Step 5-4: ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©æ›¸ä½œæˆã€æ‰€è¦æ™‚é–“: 2æ™‚é–“ã€‘

#### ä½œæ¥­å†…å®¹

å„ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¤ã„ã¦ä»¥ä¸‹ã‚’å®šç¾©ï¼š

1. **ç‰©ç†ãƒ†ãƒ¼ãƒ–ãƒ«å**
2. **è«–ç†ãƒ†ãƒ¼ãƒ–ãƒ«åï¼ˆæ—¥æœ¬èªï¼‰**
3. **ã‚«ãƒ©ãƒ å®šç¾©**
   - ã‚«ãƒ©ãƒ å
   - ãƒ‡ãƒ¼ã‚¿å‹
   - NULLè¨±å®¹
   - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
   - èª¬æ˜
4. **ä¸»ã‚­ãƒ¼ï¼ˆPrimary Keyï¼‰**
5. **å¤–éƒ¨ã‚­ãƒ¼ï¼ˆForeign Keyï¼‰**
6. **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**
7. **ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„**

#### ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¾‹

```markdown
### ãƒ†ãƒ¼ãƒ–ãƒ«: tenants

**è«–ç†å**: ãƒ†ãƒŠãƒ³ãƒˆãƒã‚¹ã‚¿

| ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---------|------|-----------|------|
| id | UUID | NO | gen_random_uuid() | ãƒ†ãƒŠãƒ³ãƒˆIDï¼ˆä¸»ã‚­ãƒ¼ï¼‰ |
| tenant_code | VARCHAR(50) | NO | - | ãƒ†ãƒŠãƒ³ãƒˆã‚³ãƒ¼ãƒ‰ï¼ˆãƒ¦ãƒ‹ãƒ¼ã‚¯ï¼‰ |
| tenant_name | VARCHAR(200) | NO | - | ãƒ†ãƒŠãƒ³ãƒˆå |
| is_active | BOOLEAN | NO | true | æœ‰åŠ¹ãƒ•ãƒ©ã‚° |
| created_at | TIMESTAMP | NO | now() | ä½œæˆæ—¥æ™‚ |
| updated_at | TIMESTAMP | NO | now() | æ›´æ–°æ—¥æ™‚ |

**ä¸»ã‚­ãƒ¼**: id  
**ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„**: tenant_code  
**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**: tenant_code, is_active
```

#### æˆæœç‰©

- å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®å®šç¾©æ›¸ï¼ˆMarkdownå½¢å¼ï¼‰

---

### Step 5-5: ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆã€æ‰€è¦æ™‚é–“: 1æ™‚é–“ã€‘

#### ä½œæ¥­å†…å®¹

1. **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ**

   ```bash
   cd D:\projects\HarmoNet
   npx supabase migration new create_initial_schema
   ```

   ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ï¼š
   ```
   supabase/migrations/20251104XXXXXX_create_initial_schema.sql
   ```

2. **SQLã®è¨˜è¿°**

   ```sql
   -- ãƒ†ãƒŠãƒ³ãƒˆãƒã‚¹ã‚¿
   CREATE TABLE tenants (
       id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
       tenant_code VARCHAR(50) NOT NULL UNIQUE,
       tenant_name VARCHAR(200) NOT NULL,
       is_active BOOLEAN NOT NULL DEFAULT true,
       created_at TIMESTAMP NOT NULL DEFAULT now(),
       updated_at TIMESTAMP NOT NULL DEFAULT now()
   );

   -- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ
   CREATE INDEX idx_tenants_code ON tenants(tenant_code);
   CREATE INDEX idx_tenants_active ON tenants(is_active);

   -- ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ 
   COMMENT ON TABLE tenants IS 'ãƒ†ãƒŠãƒ³ãƒˆãƒã‚¹ã‚¿';
   COMMENT ON COLUMN tenants.id IS 'ãƒ†ãƒŠãƒ³ãƒˆID';
   COMMENT ON COLUMN tenants.tenant_code IS 'ãƒ†ãƒŠãƒ³ãƒˆã‚³ãƒ¼ãƒ‰';
   ```

3. **ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—è‡ªå‹•æ›´æ–°ãƒˆãƒªã‚¬ãƒ¼ã®ä½œæˆ**

   ```sql
   -- æ›´æ–°æ—¥æ™‚è‡ªå‹•æ›´æ–°é–¢æ•°
   CREATE OR REPLACE FUNCTION update_updated_at_column()
   RETURNS TRIGGER AS $$
   BEGIN
       NEW.updated_at = now();
       RETURN NEW;
   END;
   $$ language 'plpgsql';

   -- ãƒˆãƒªã‚¬ãƒ¼è¨­å®š
   CREATE TRIGGER update_tenants_updated_at 
       BEFORE UPDATE ON tenants
       FOR EACH ROW
       EXECUTE FUNCTION update_updated_at_column();
   ```

#### æˆæœç‰©

- ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³SQLãƒ•ã‚¡ã‚¤ãƒ«

---

### Step 5-6: ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œã€æ‰€è¦æ™‚é–“: 10åˆ†ã€‘

#### ä½œæ¥­å†…å®¹

1. **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®é©ç”¨**

   ```bash
   npx supabase db push
   ```

2. **é©ç”¨çµæœã®ç¢ºèª**

   ```bash
   npx supabase db diff
   ```

   æœŸå¾…çµæœ: `No schema changes detected.`

3. **Studio UIã§ãƒ†ãƒ¼ãƒ–ãƒ«ç¢ºèª**

   - ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://127.0.0.1:54323` ã‚’é–‹ã
   - å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã€ŒTable Editorã€ã‚’ã‚¯ãƒªãƒƒã‚¯
   - ä½œæˆã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

4. **SQL Editorã§ç¢ºèª**

   ```sql
   -- ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§
   SELECT table_name 
   FROM information_schema.tables 
   WHERE table_schema = 'public';

   -- ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ç¢ºèª
   \d tenants
   ```

#### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

**ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ**:

```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆ
npx supabase db reset

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†å®Ÿè¡Œ
npx supabase db push
```

---

### Step 5-7: Row Level Security (RLS) è¨­å®šã€æ‰€è¦æ™‚é–“: 1æ™‚é–“ã€‘

#### ä½œæ¥­å†…å®¹

1. **RLSã®æœ‰åŠ¹åŒ–**

   ```sql
   -- RLSæœ‰åŠ¹åŒ–
   ALTER TABLE tenants ENABLE ROW LEVEL SECURITY;
   ```

2. **ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ**

   ```sql
   -- å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‡ªåˆ†ã®ãƒ†ãƒŠãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å‚ç…§å¯èƒ½
   CREATE POLICY "Users can view their tenant"
       ON tenants
       FOR SELECT
       USING (
           id = auth.jwt() ->> 'tenant_id'::UUID
       );

   -- ç®¡ç†è€…ã®ã¿æŒ¿å…¥å¯èƒ½
   CREATE POLICY "Admins can insert tenants"
       ON tenants
       FOR INSERT
       WITH CHECK (
           auth.jwt() ->> 'role' = 'admin'
       );
   ```

3. **ãƒãƒªã‚·ãƒ¼ã®ãƒ†ã‚¹ãƒˆ**

   - Studio UIã‹ã‚‰ã€ŒAuthenticationã€â†’ã€ŒPoliciesã€ã§ç¢ºèª
   - SQL Editorã§ãƒ†ã‚¹ãƒˆã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œ

#### æˆæœç‰©

- RLSè¨­å®šSQLãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«å«ã‚ã‚‹ï¼‰

---

### Step 5-8: åˆæœŸãƒ‡ãƒ¼ã‚¿æŠ•å…¥ã€æ‰€è¦æ™‚é–“: 30åˆ†ã€‘

#### ä½œæ¥­å†…å®¹

1. **ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ**

   ```bash
   # seed.sqlã®ç·¨é›†
   # supabase/seed.sql
   ```

2. **åˆæœŸãƒ‡ãƒ¼ã‚¿ã®INSERTæ–‡ä½œæˆ**

   ```sql
   -- åˆæœŸãƒ†ãƒŠãƒ³ãƒˆ
   INSERT INTO tenants (tenant_code, tenant_name) VALUES
   ('SYSTEM', 'ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†'),
   ('DEMO', 'ãƒ‡ãƒ¢ãƒ†ãƒŠãƒ³ãƒˆ');

   -- åˆæœŸãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆä¾‹ï¼‰
   -- ä»–ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚‚å¿…è¦ã«å¿œã˜ã¦åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥
   ```

3. **ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥**

   ```bash
   npx supabase db reset
   ```

   â€» `db reset` ã¯ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å†å®Ÿè¡Œ + seed.sqlå®Ÿè¡Œ

4. **ãƒ‡ãƒ¼ã‚¿ç¢ºèª**

   ```sql
   SELECT * FROM tenants;
   ```

#### æˆæœç‰©

- `supabase/seed.sql`ï¼ˆåˆæœŸãƒ‡ãƒ¼ã‚¿å®šç¾©ï¼‰

---

## âœ… Phase 5å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

ä½œæ¥­å®Œäº†æ™‚ã«ä»¥ä¸‹ã‚’ç¢ºèªï¼š

- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒŠãƒ¬ãƒƒã‚¸ã®è¦ä»¶ã‚’ç¢ºèªã—ãŸ
- [ ] ERå›³ã‚’ä½œæˆã—ãŸ
- [ ] å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®å®šç¾©æ›¸ã‚’ä½œæˆã—ãŸ
- [ ] ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ãŸ
- [ ] ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é©ç”¨ã—ãŸ
- [ ] Studio UIã§ãƒ†ãƒ¼ãƒ–ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] RLSã‚’è¨­å®šã—ãŸ
- [ ] åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥ã—ãŸ
- [ ] ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãæŒ¿å…¥ã•ã‚Œã¦ã„ã‚‹

---

## ğŸ“ Phase 5æˆæœç‰©ä¸€è¦§

å®Œäº†æ™‚ã«ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã‚‹ï¼š

```
D:\projects\HarmoNet\
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ database/
â”‚       â”œâ”€â”€ 03_harmonet-er-diagram_v1.0.md          # ERå›³
â”‚       â”œâ”€â”€ 04_harmonet-table-definitions_v1.0.md   # ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©æ›¸
â”‚       â””â”€â”€ 05_harmonet-rls-policies_v1.0.md        # RLSãƒãƒªã‚·ãƒ¼å®šç¾©
â”œâ”€â”€ supabase/
â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ 20251104XXXXXX_create_initial_schema.sql  # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³SQL
â”‚   â””â”€â”€ seed.sql                                       # åˆæœŸãƒ‡ãƒ¼ã‚¿
```

---

## ğŸ¯ Phase 6äºˆå‘Š: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç’°å¢ƒæ§‹ç¯‰

Phase 5å®Œäº†å¾Œã¯ä»¥ä¸‹ã‚’äºˆå®šï¼š

1. **Next.jsç’°å¢ƒæ§‹ç¯‰**
   - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
   - TypeScriptè¨­å®š
   - Tailwind CSSå°å…¥

2. **Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®š**
   - `@supabase/supabase-js` ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
   - ç’°å¢ƒå¤‰æ•°è¨­å®š

3. **èªè¨¼ãƒ•ãƒ­ãƒ¼å®Ÿè£…**
   - ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
   - èªè¨¼å‡¦ç†

---

## ğŸ“ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### SupabaseãŒèµ·å‹•ã—ãªã„å ´åˆ

```bash
# Docker Desktopå†èµ·å‹•
# 1. Docker Desktopã‚’å®Œå…¨çµ‚äº†
# 2. 30ç§’å¾…ã¤
# 3. Docker Desktopå†èµ·å‹•

# Supabaseå†èµ·å‹•
cd D:\projects\HarmoNet
npx supabase stop
npx supabase start
```

### ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ã®å ´åˆ

```bash
# ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œ
npx supabase db push --debug

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒªã‚»ãƒƒãƒˆ
npx supabase db reset
```

### å‚ç…§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **å‰å›ä½œæ¥­è¨˜éŒ²**: `01_harmonet-supabase-setup-log_v1.0.md`
- **Supabaseå…¬å¼**: https://supabase.com/docs/guides/database
- **PostgreSQLå…¬å¼**: https://www.postgresql.jp/document/

---

## ğŸ™‹ è³ªå•ãƒ»ä¸æ˜ç‚¹ãŒã‚ã‚‹å ´åˆ

ä½œæ¥­ä¸­ã«ä¸æ˜ç‚¹ãŒå‡ºãŸå ´åˆï¼š

1. ã¾ãšãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒŠãƒ¬ãƒƒã‚¸ã‚’ç¢ºèª
2. ä½œæ¥­è¨˜éŒ²ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§
3. æ¨æ¸¬ã›ãšè³ªå•ã™ã‚‹

---

**ğŸ“Œ ã“ã®ä½œæ¥­æŒ‡ç¤ºæ›¸ã«å¾“ã£ã¦ã€Phase 5ã‚’é€²ã‚ã¦ãã ã•ã„ã€‚**
**ğŸ“Œ ä½œæ¥­å®Œäº†å¾Œã¯ã€Phase 5å®Œäº†å ±å‘Šæ›¸ã‚’ä½œæˆã—ã¾ã™ã€‚**
