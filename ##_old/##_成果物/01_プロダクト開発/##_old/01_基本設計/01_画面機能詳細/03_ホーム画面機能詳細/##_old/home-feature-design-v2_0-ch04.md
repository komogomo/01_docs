# 第4章: お知らせセクション

**Document:** HOME画面 機能設計書 v2.0  
**Chapter:** 4 of 5  
**Last Updated:** 2025/10/27

---

## 4.1 表示内容

お知らせセクションは、住民にとって重要な情報を一覧表示するセクションです。

### 表示ルール

| 項目 | 仕様 |
|------|------|
| **表示件数** | 最新のお知らせを**3件まで**表示 |
| **並び順** | 公開日時の降順（新しいものが上） |
| **未読表示** | 未読のお知らせには「未読」バッジを表示 |
| **空状態** | お知らせがない場合: 「現在お知らせはありません」と表示 |

### データソース

**取得元:**
- お知らせマスタテーブル
- 既読管理テーブル（ユーザーごとの既読状態）

**取得条件:**
- ステータス: 公開中
- 公開日時: 現在日時以前
- 並び順: 公開日時 降順
- 取得件数: 3件

---

## 4.2 表示項目

### お知らせカードの構成

各お知らせカードには以下の項目を表示します:

| 項目 | 説明 | データソース | 必須 |
|------|------|--------------|------|
| **カテゴリバッジ** | お知らせの種類を色で識別 | お知らせマスタ | ✅ |
| **タイトル** | お知らせの件名（最大50文字） | お知らせマスタ | ✅ |
| **投稿日時** | 「YYYY/MM/DD HH:MM」形式 | お知らせマスタ | ✅ |
| **未読バッジ** | 未読の場合のみ表示 | 既読管理テーブル | ⭕️ |

### 表示例

**お知らせカード（未読）:**
```
┌──────────────────────────────────┐
│ [イベント]  【未読】   2025/10/20│
│                                  │
│ 秋祭りのお知らせ                  │
└──────────────────────────────────┘
```

**お知らせカード（既読）:**
```
┌──────────────────────────────────┐
│ [連絡]              2025/10/15   │
│                                  │
│ ゴミ収集日変更について            │
└──────────────────────────────────┘
```

---

## 4.3 インタラクション

### タップ操作

**お知らせカードをタップ:**
- 遷移先: お知らせ詳細画面
- パラメータ: お知らせID
- 効果: 未読の場合、自動的に既読に変更

**「一覧を見る」ボタンをタップ:**
- 遷移先: お知らせ一覧画面
- 表示内容: 全てのお知らせを表示

### ホバー効果（PC/タブレット）

**マウスオーバー時:**
```css
.notification-card:hover {
  background-color: #f5f5f5;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  transition: all 0.3s ease;
}
```

### 視覚的フィードバック

**タップ時（モバイル）:**
```css
.notification-card:active {
  background-color: #e0e0e0;
  transform: scale(0.98);
}
```

---

## 4.4 カテゴリバッジの色分け

お知らせの種類は、カテゴリバッジの色で視覚的に識別できます。

### カテゴリ別カラー定義

| カテゴリ | バッジ色 | 背景色 | 文字色 | 用途 |
|----------|----------|--------|--------|------|
| **重要** | 赤系 | `#f44336` | `#ffffff` | 緊急性の高い連絡、注意喚起 |
| **イベント** | 緑系 | `#4caf50` | `#ffffff` | 自治会イベント告知、行事案内 |
| **連絡** | 青系 | `#2196f3` | `#ffffff` | 一般的な連絡事項、お知らせ |
| **メンテナンス** | オレンジ系 | `#ff9800` | `#ffffff` | 設備点検、工事連絡 |

### デザイン仕様

**バッジサイズ:**
- パディング: 上下4px 左右12px
- フォントサイズ: 0.75em (12px)
- 角丸: border-radius 12px

**配置:**
- お知らせカード左上に配置
- 他の要素との間隔: 8px

### カテゴリの多言語対応

| カテゴリ | 日本語(JA) | 英語(EN) | 中国語(CN) |
|----------|-----------|---------|-----------|
| 重要 | 重要 | Important | 重要 |
| イベント | イベント | Event | 活动 |
| 連絡 | 連絡 | Notice | 通知 |
| メンテナンス | メンテナンス | Maintenance | 维护 |

---

## 4.5 未読バッジの仕様

### デザイン

**カラー:**
- 背景色: `#ff9800` (オレンジ)
- 文字色: `#ffffff` (白)

**サイズ:**
- パディング: 上下2px 左右8px
- フォントサイズ: 0.7em (11.2px)
- 角丸: border-radius 10px

**配置:**
- お知らせカード右上に配置
- 投稿日時の左隣

### 表示条件

**未読判定:**
```javascript
// ユーザーIDとお知らせIDの組み合わせで既読テーブルを検索
const isUnread = !notificationReads.find(
  read => read.userId === currentUser.id && 
          read.notificationId === notification.id
);
```

**多言語対応:**
| 言語 | 表示テキスト |
|------|-------------|
| 日本語 | 未読 |
| 英語 | NEW |
| 中国語 | 未读 |

---

## 4.6 空状態の表示

### お知らせが0件の場合

**表示メッセージ:**
```
📭
現在お知らせはありません
```

**多言語対応:**
| 言語 | メッセージ |
|------|-----------|
| 日本語 | 現在お知らせはありません |
| 英語 | No notifications at this time |
| 中国語 | 目前没有通知 |

**デザイン:**
- アイコン: 📭 (中央配置)
- テキスト: グレー (#757575)
- フォントサイズ: 1em
- パディング: 上下40px

---

## 4.7 レスポンシブ対応

### デバイス別レイアウト

| デバイス | カード幅 | フォントサイズ | 間隔 |
|---------|---------|---------------|------|
| **PC** | 100% (最大1024px) | 基準サイズ | 16px |
| **タブレット** | 100% | 基準サイズ | 12px |
| **スマートフォン** | 100% | 0.9倍 | 8px |

### タイトルの省略表示

**最大表示文字数:**
- PC: 50文字
- タブレット: 40文字
- スマートフォン: 30文字

**オーバーフロー処理:**
```css
.notification-title {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
```

---

## 4.8 アクセシビリティ

### スクリーンリーダー対応

**セマンティックHTML:**
```html
<section aria-labelledby="notifications-heading">
  <h2 id="notifications-heading">最新のお知らせ</h2>
  <ul role="list">
    <li>
      <article aria-label="イベント お知らせ 未読">
        <!-- お知らせカードの内容 -->
      </article>
    </li>
  </ul>
</section>
```

**ARIAラベル:**
- 未読バッジ: `aria-label="未読"`
- カテゴリバッジ: `aria-label="カテゴリ: イベント"`

### キーボードナビゲーション

**Tab順序:**
1. お知らせカード1
2. お知らせカード2
3. お知らせカード3
4. 「一覧を見る」ボタン

**Enterキー:**
- お知らせカードにフォーカス時: 詳細画面へ遷移
- 「一覧を見る」ボタン: 一覧画面へ遷移

---

**[← 前の章: 第3章 ウェルカムセクション](home-feature-design-v2_0-ch03.md)**

**[次の章へ: 第5章 機能タイルセクション →](home-feature-design-v2_0-ch05.md)**

**[目次に戻る ↑](home-feature-design-v2_0-index.md)**
