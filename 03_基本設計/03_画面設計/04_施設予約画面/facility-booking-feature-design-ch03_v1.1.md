# Chapter 03: 予約フロー・画面構成

**HarmoNet 施設予約機能 基本設計書**

---

## 改訂履歴

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| v1.0 | 2025-10-29 | TKD + Claude | 初版作成 |
| v1.1 | 2025-11-28 | TKD + Claude | 集会所フロー追加、タブ切替UI、料金除外、マイページ遷移明確化 |

---

## 目次

1. [画面一覧](#1-画面一覧)
2. [画面遷移](#2-画面遷移)
3. [施設予約TOP画面](#3-施設予約top画面)
4. [集会所の予約フロー](#4-集会所の予約フロー)
5. [駐車場の予約フロー](#5-駐車場の予約フロー)
6. [予約確認画面](#6-予約確認画面)
7. [予約詳細画面（マイページ）](#7-予約詳細画面マイページ)

---

## 1. 画面一覧

| 画面ID | 画面名 | 役割 | 遷移元 |
|--------|--------|------|--------|
| FB-01 | 施設予約TOP | 施設タブ切替、カレンダー表示 | フッター「予約」 |
| FB-02 | 時間枠選択（集会所） | 時間枠選択、使用目的入力 | FB-01（日付選択後） |
| FB-03 | 区画選択（駐車場） | 配置図表示、区画選択 | FB-01（日付選択後） |
| FB-04 | 予約確認 | 内容確認、注意事項同意、確定 | FB-02 または FB-03 |
| FB-05 | 予約完了 | 完了メッセージ、次のアクション | FB-04（確定後） |
| FB-06 | 予約詳細 | 予約内容表示、変更、キャンセル | マイページのみ |

---

## 2. 画面遷移

### 2.1 全体遷移図

```
フッター「予約」
    ↓
┌─────────────────────────────────────┐
│ FB-01 施設予約TOP                    │
│ ┌─────────┐ ┌─────────────┐         │
│ │ 集会所  │ │ ゲスト駐車場 │ ← タブ切替 │
│ └─────────┘ └─────────────┘         │
│                                      │
│ 月カレンダー（日付選択）              │
└─────────────────────────────────────┘
    ↓ 日付選択
    ↓
┌──────────────┐    ┌──────────────┐
│ FB-02        │    │ FB-03        │
│ 時間枠選択    │    │ 区画選択     │
│ （集会所）    │    │ （駐車場）   │
└──────────────┘    └──────────────┘
    ↓                    ↓
    └────────┬───────────┘
             ↓
┌─────────────────────────────────────┐
│ FB-04 予約確認                       │
│ 予約内容サマリ                       │
│ 注意事項表示                         │
│ 同意チェック                         │
│ [戻る] [予約を確定]                  │
└─────────────────────────────────────┘
             ↓ 確定
┌─────────────────────────────────────┐
│ FB-05 予約完了                       │
│ 完了メッセージ                       │
│ [ホームに戻る] [予約履歴を見る]       │
└─────────────────────────────────────┘
```

### 2.2 マイページからの遷移

```
マイページ
    ↓
予約履歴一覧
    ↓ 予約タップ
┌─────────────────────────────────────┐
│ FB-06 予約詳細                       │
│ 予約情報（施設、日時、目的等）        │
│ ステータス                           │
│ [予約を変更] [この予約をキャンセル]   │
└─────────────────────────────────────┘
```

### 2.3 遷移ルール

- 予約詳細画面（FB-06）はマイページからのみアクセス可能
- 施設予約画面から予約詳細への直接遷移は不可
- 予約完了後は「予約履歴を見る」でマイページへ遷移

---

## 3. 施設予約TOP画面

### 3.1 画面構成

```
┌─────────────────────────────────────┐
│ < 施設予約          JA | EN | ZH    │
├─────────────────────────────────────┤
│ ┌─────────┐ ┌─────────────┐         │
│ │🏠集会所 │ │🚗ゲスト駐車場│         │
│ └─────────┘ └─────────────┘         │
├─────────────────────────────────────┤
│ 📍 集会所（セキュレアステーション）   │
│ ・使用時間：9:00-19:00（30分単位）   │
│ ・定員：約30名                       │
│ ・設備：テーブル・椅子・プロジェクター │
│ 📄 利用規約を確認                    │
├─────────────────────────────────────┤
│        2025年11月         < >       │
│ 日  月  火  水  木  金  土           │
│                          1   2      │
│  3   4   5   6   7   8   9          │
│ 10  11  12  13  14  15  16          │
│ ...                                  │
└─────────────────────────────────────┘
```

### 3.2 タブ切替

- 「集会所」タブ: 集会所の情報カード + カレンダー
- 「ゲスト駐車場」タブ: 駐車場の情報カード + カレンダー

### 3.3 施設情報カード

**集会所:**
- 施設名称
- 使用時間帯
- 定員
- 設備
- 「利用規約を確認」リンク → 掲示板投稿へ

**駐車場:**
- 施設名称
- 台数
- 使用時間
- 予約可能期間
- 「利用規約を確認」リンク → 掲示板投稿へ

### 3.4 カレンダー

- 月カレンダー形式
- 当月〜翌月末を表示
- 過去日は非活性
- 日付タップで次画面へ遷移

---

## 4. 集会所の予約フロー

### 4.1 フロー概要

```
1. 施設予約TOP → 集会所タブ選択
2. カレンダーで日付選択
3. 時間枠選択画面（FB-02）
   - 時間枠選択（30分単位、9:00-19:00）
   - 使用目的入力（必須）
   - 参加人数入力（任意）
4. 予約確認画面（FB-04）
5. 予約確定 → 完了画面（FB-05）
```

### 4.2 時間枠選択画面（FB-02）

```
┌─────────────────────────────────────┐
│ < 時間枠選択        JA | EN | ZH    │
├─────────────────────────────────────┤
│ 選択した日付： 2025年11月15日        │
├─────────────────────────────────────┤
│ 開始時刻                             │
│ [09:00 ▼]                           │
│                                      │
│ 終了時刻                             │
│ [12:00 ▼]                           │
├─────────────────────────────────────┤
│ 使用目的（必須）                      │
│ ┌─────────────────────────────────┐ │
│ │                                 │ │
│ └─────────────────────────────────┘ │
│                                      │
│ 参加人数（任意）                      │
│ [    ] 名                           │
├─────────────────────────────────────┤
│ [戻る]              [次へ]          │
└─────────────────────────────────────┘
```

### 4.3 入力項目

| 項目 | 必須 | 形式 |
|------|------|------|
| 開始時刻 | ○ | 30分刻み（9:00〜18:30） |
| 終了時刻 | ○ | 30分刻み（9:30〜19:00） |
| 使用目的 | ○ | テキスト |
| 参加人数 | - | 数値 |

---

## 5. 駐車場の予約フロー

### 5.1 フロー概要

```
1. 施設予約TOP → ゲスト駐車場タブ選択
2. カレンダーで日付選択
3. 区画選択画面（FB-03）
   - 配置図表示
   - 区画ボタンで空き確認・選択
4. 予約確認画面（FB-04）
5. 予約確定 → 完了画面（FB-05）
```

### 5.2 区画選択画面（FB-03）

```
┌─────────────────────────────────────┐
│ < 区画選択          JA | EN | ZH    │
├─────────────────────────────────────┤
│ 選択した日付： 2025年11月15日        │
├─────────────────────────────────────┤
│ 駐車場配置図                         │
│ ┌─────────────────────────────────┐ │
│ │    つくば市学園の森義務教育学校方面  │ │
│ │       ┌───┐ ┌───┐              │ │
│ │       │ ② │ │ ① │              │ │
│ │       └───┘ └───┘              │ │
│ │    ┌─────────────────┐         │ │
│ │    │    集会所        │         │ │
│ │    └─────────────────┘         │ │
│ │    ┌───┐ ┌───┐ ┌───┐          │ │
│ │    │ ⑥ │ │ ⑤ │ │ ④ │          │ │
│ │    └───┘ └───┘ └───┘          │ │
│ │       ┌───┐ ┌───┐              │ │
│ │       │ ⑧ │ │ ⑦ │              │ │
│ │       └───┘ └───┘              │ │
│ │       研究学園駅方面               │ │
│ └─────────────────────────────────┘ │
├─────────────────────────────────────┤
│ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐   │
│ │①番 │ │②番 │ │③番 │ │④番 │   │
│ │ 空き │ │ 空き │ │予約済│ │ 空き │   │
│ └─────┘ └─────┘ └─────┘ └─────┘   │
│ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐   │
│ │⑤番 │ │⑥番 │ │⑦番 │ │⑧番 │   │
│ │ 空き │ │ 空き │ │ 空き │ │ 空き │   │
│ └─────┘ └─────┘ └─────┘ └─────┘   │
├─────────────────────────────────────┤
│ [戻る]              [次へ]          │
└─────────────────────────────────────┘
```

### 5.3 区画ボタン状態

| 状態 | 表示 | 操作 |
|------|------|------|
| 空き | 緑枠 | タップ可能 |
| 予約済み（他） | グレー | タップ不可 |
| 自分の予約 | 青枠 | タップ可能 |
| 管理者ブロック | 黒 | タップ不可 |

---

## 6. 予約確認画面

### 6.1 画面構成（共通）

```
┌─────────────────────────────────────┐
│ < 予約確認          JA | EN | ZH    │
├─────────────────────────────────────┤
│ 予約内容                             │
│ 🏠 施設                              │
│    ゲスト駐車場 8番                   │
│ 📅 予約日時                          │
│    2025/10/31 終日                   │
│ 👤 申込者                            │
│    住戸番号 B71                      │
├─────────────────────────────────────┤
│ 📌 ご利用にあたって                   │
│ ・使用後は清掃をお願いします          │
│ ・ゴミは各自でお持ち帰りください       │
│ ・設備の破損・汚損があった場合は      │
│   ご連絡ください                     │
│ ・キャンセルの場合は前日までに        │
│   ご連絡ください                     │
├─────────────────────────────────────┤
│ ☐ 上記の注意事項を確認し、同意します  │
├─────────────────────────────────────┤
│ [戻る]          [予約を確定]         │
└─────────────────────────────────────┘
```

### 6.2 表示項目

**共通:**
- 施設名
- 予約日
- 申込者（住戸番号）

**集会所の場合:**
- 利用時間（開始〜終了）
- 使用目的
- 参加人数

**駐車場の場合:**
- 区画番号
- 終日表示

### 6.3 注意事項

- 施設タイプ毎に異なる注意事項を表示
- 同意チェック必須
- チェックなしで「予約を確定」押下 → エラー表示

---

## 7. 予約詳細画面（マイページ）

### 7.1 アクセス経路

- マイページ → 予約履歴一覧 → 予約タップ → 予約詳細

### 7.2 画面構成

```
┌─────────────────────────────────────┐
│ < 予約詳細          JA | EN | ZH    │
├─────────────────────────────────────┤
│ 予約情報                             │
│ 🏠 施設                              │
│    集会所（セキュレアステーション）    │
│ 📅 予約日                            │
│    2025/10/31                       │
│ 🕐 利用時間                          │
│    9:00-12:00                       │
│ 📝 使用目的                          │
│    住民懇親会                        │
│ 👥 参加人数                          │
│    20名                             │
│ ✅ ステータス                        │
│    予約確定                          │
│ 📅 予約日時                          │
│    2025/10/26                       │
├─────────────────────────────────────┤
│ ┌─────────────────────────────────┐ │
│ │       ✏️ 予約を変更              │ │
│ └─────────────────────────────────┘ │
│                                      │
│        この予約をキャンセル           │
└─────────────────────────────────────┘
```

### 7.3 操作

| ボタン | 動作 |
|--------|------|
| 予約を変更 | 予約内容の変更画面へ遷移 |
| この予約をキャンセル | キャンセル確認モーダル表示 |

### 7.4 キャンセル条件

- 集会所: 使用開始時間前までキャンセル可能
- 駐車場: 前日までキャンセル可能
- 期限を過ぎている場合はキャンセルボタン非活性

---

**Document ID**: HARMONET-FACILITY-BOOKING-DESIGN-001-CH03  
**Status**: 確定版  
**Created**: 2025-10-29  
**Last Updated**: 2025-11-28  
**Version**: v1.1  
**Authors**: TKD + Claude  

---

© 2025 HarmoNet Project. All rights reserved.
