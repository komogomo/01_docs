# HOME 基本設計書 ch01：概要

**Document:** HOME画面 基本設計書（コンテンツ領域）
**Version:** v1.2
**Date:** 2025-11-21
**Author:** TKD / Tachikoma
**Status:** Draft
**Supersedes:** home-feature-design-ch01_v1.1.md

---

## 1. 本書の位置づけ

### 1.1 対象範囲

本書は、HarmoNet のログイン後トップ画面である **HOME 画面** のうち、
「コンテンツ領域（ヘッダー直下〜フッター直上）」の基本設計を示す。

* 対象に含む

  * HOME 画面の情報構成（セクション構成）
  * コンテンツ領域のレイアウト方針
  * コンテンツ領域で表示する情報種別（最新のお知らせ・機能タイル）の役割
  * 掲示板機能との連携方針（NOTICE / ALL / RULES などのフィルタ観点）
* 対象外

  * AppHeader / AppFooter 自体の詳細仕様（別紙「共通部品」設計書で定義）
  * ログインフロー／セッション管理（LoginPage, MagicLinkForm 等の設計書で定義）
  * 掲示板詳細画面・投稿画面のレイアウト／動作仕様（掲示板詳細設計書で定義）

### 1.2 他文書との関係

本書は、以下の文書と整合することを前提とする。

* 機能要件定義書（最新版）
* 非機能要件定義書（最新版）
* 技術スタック定義書（最新版）
* A-00 LoginPage 基本設計書・詳細設計書（ログイン完了後の遷移先として HOME を定義）
* 掲示板機能 基本設計書／詳細設計書（掲示板TOP・フィルタ仕様の一次定義）
* 共通部品 基本設計書（AppHeader / AppFooter / StaticI18nProvider など）

HOME 画面のコンテンツ領域は、上記の要件・共通部品仕様を前提に「利用者が最初に目にするポータル」としての役割を担う。

---

## 2. HOME 画面の役割と前提

### 2.1 HOME 画面の役割

HOME 画面は、ログイン後に最初に表示されるポータル画面として、以下を目的とする。

1. 「重要なお知らせ」を簡潔に提示する

   * 管理組合からの NOTICE タグ付き掲示を、コンパクトにチラ見せすることで、
     重要情報の見落としを防ぐ。
2. よく使う機能への入口をまとめる

   * 掲示板（ALL/NOTICE/RULES）、施設予約、通知設定など、
     利用頻度の高い機能へのショートカットをカードタイルとして一覧化する。
3. 将来機能の拡張を見据えたポータル

   * 機能タイルは、将来の機能追加（例：アンケート、申請フォーム）を想定し、
     グリッドレイアウトにより拡張性を確保する。

### 2.2 UI トーン・デザイン方針

HOME 画面のコンテンツ領域は、HarmoNet 全体のデザイン方針に従う。

* トーン:

  * やさしい・自然・控えめ
  * Apple カタログ風のミニマルな構成
* フォント:

  * BIZ UD ゴシック系（Web フォントの実装は別途定義）
* コンポーネントの共通性:

  * 角丸 2xl 程度のカードタイル
  * 必要最小限のシャドウと境界線
  * lucide-react の線形アイコンを用いたシンプルな表現
* レスポンシブ方針:

  * スマートフォン（縦長）を主ターゲットとし、
    1画面内に「最新のお知らせ」＋「機能タイル 2×3」が概ね収まるバランスを優先する。

---

## 3. 情報構成（コンテンツ領域）

### 3.1 セクション構成

HOME 画面のコンテンツ領域は、以下 2 セクションのみで構成する。

1. セクションA：最新のお知らせ
2. セクションB：機能タイル（2×3 グリッド）

AppHeader / AppFooter は共通部品として別途定義し、本書では詳細を扱わない。

### 3.2 セクションA：最新のお知らせ

#### 3.2.1 役割

* 掲示板のうち、`NOTICE` タグが付与された投稿の中から、
  テナントごとに指定された件数だけを HOME 上部に表示する。
* 利用者が HOME を開いた瞬間に「重要なお知らせ」が目に入り、
  必要に応じて掲示板詳細へ遷移できることを目的とする。

#### 3.2.2 表示件数

* デフォルト表示件数: **2件**
* テナント設定により 1〜3件の範囲で変更可能とする。

  * 設定値 > 3 の場合は 3 件を上限とする（UI 崩れ防止のため）。
  * 実際の表示件数は `min(設定値, NOTICE 投稿件数, 3)` とする。

#### 3.2.3 抽出・ソート条件（概要）

* 抽出条件:

  * 掲示板投稿テーブル（例：`board_posts`）のうち、

    * 対象テナントのレコード
    * タグ（またはカテゴリ）が `NOTICE` に該当するもの
    * 公開開始日・終了日の条件を満たすもの（公開中）
* ソート条件:

  1. `pinned` フラグ（固定表示）降順
  2. `created_at` 降順（新しい順）

（詳細なクエリ・インデックス設計は掲示板詳細設計書で定義する。）

#### 3.2.4 UI の概要

* セクションタイトル: 「最新のお知らせ」
* 表示形式:

  * 1〜数件のカードを縦方向に並べるシンプルなリスト形式
  * 各カードには、タグバッジ（「お知らせ」）、投稿日（`YYYY/MM/DD`）、
    タイトル（2行まで）を表示する。
* 0件の場合:

  * 「現在表示するお知らせはありません。」とテキストのみ表示する。

カードタップ時の遷移先は、掲示板詳細画面（例：`/board/{postId}`）とするが、
HOME 基本設計の段階では「HOME から掲示板詳細へ遷移できる」という方針のみを定義し、
URL パターンおよびパラメータ仕様は掲示板詳細設計書に委譲する。

### 3.3 セクションB：機能タイル

#### 3.3.1 役割

* 利用頻度の高い機能への入口を 2×3 のカードタイルとしてまとめ、
  HOME 画面を「機能ポータル」として機能させる。
* 掲示板機能は 1つの実体（掲示板TOP画面）に対して、
  タイルごとに異なるフィルタ状態（ALL / NOTICE / RULES など）で遷移する想定とする。

#### 3.3.2 タイル構成（概要）

* 上段（フッターナビと意味を揃える）

  1. お知らせ
  2. 掲示板
  3. 施設予約
* 下段
  4. 運用ルール
  5. 通知設定
  6. ダミー（将来機能枠）

各タイルの詳細な説明文・アイコン・遷移先 URL については、ch04 にて定義する。
本 ch01 では「何のタイルを置くか」「掲示板との関係をどう考えるか」のみを扱う。

---

## 4. 掲示板との関係

### 4.1 掲示板の位置づけ

本システムでは、

* 「掲示板」「回覧板」「お知らせ」「運用ルール」などは、
  **すべて同一の掲示板機能（掲示板TOP画面＋投稿テーブル）上で管理する**。
* 区別は、投稿に付与されたタグ（またはカテゴリ）と、画面側のフィルタ状態で行う。

今後、雑談用途の「雑談板」は設けず、
掲示板はすべて「公式な情報（管理組合からのお知らせ・運用連絡など）」を扱う場とする。

### 4.2 HOME から掲示板への導線

HOME 画面から掲示板機能へは、以下のように導線と役割を分担する。

* セクションA：最新のお知らせ

  * NOTICE タグ付き投稿の一部を HOME 上でチラ見せし、
    カードタップで掲示板詳細へ遷移する。
* セクションB：機能タイル

  * お知らせタイル

    * 掲示板TOP（NOTICE フィルタ）のショートカット
  * 掲示板タイル

    * 掲示板TOP（ALL フィルタ）のショートカット
  * 運用ルールタイル

    * 掲示板TOP（RULES フィルタ）またはルール専用画面へのショートカット

AppFooter の「掲示板」アイコンは、
掲示板TOP（ALL フィルタ）のショートカットとして統一し、
HOME 機能タイルの「掲示板」タイルと役割を揃える。

フィルタのキー名（`ALL` / `NOTICE` / `RULES` 等）や、
URL パラメータの形式（例：`/board?tag=NOTICE`）は、
掲示板詳細設計書およびルーティング設計で確定させる。

---

## 5. 非機能・制約（HOME 画面に関わるもの）

### 5.1 パフォーマンス

* HOME 画面表示時には、

  * NOTICE タグ付きの掲示板投稿（最大 3 件）
  * 将来導入するテナント設定（HOME 上のお知らせ件数）
    の2種類のデータ取得が発生することを前提とする。
* 掲示板投稿の取得は、Supabase（PostgreSQL）側のインデックス設計により、
  1画面表示以内で完了する応答時間を目標とする（詳細は掲示板側で定義）。

### 5.2 権限・認可

* HOME 画面に表示される情報は、

  * ログイン済み利用者の tenant_id に紐づくデータのみとする。
  * 掲示板投稿の閲覧権限は、掲示板側の RLS ポリシーに従う。
* HOME 画面では、閲覧専用の情報のみを扱う（投稿・編集は行わない）。

### 5.3 多言語対応

* セクションタイトル（例：「最新のお知らせ」）やタイルのラベルは、
  StaticI18nProvider を用いた静的 i18n キーで管理する。
* 掲示板投稿の本文／タイトルはユーザー生成コンテンツ（UGC）であり、
  多言語自動変換は本書の範囲外とする（将来要件）。

---

## 6. 今後の詳細設計への引き継ぎ

* 本 ch01 で定義した内容を前提として、

  * ch02：画面レイアウトとコンポーネント構成
  * ch03：データ項目・状態管理
  * ch04：機能タイル一覧・遷移先
  * ch05：エラーハンドリング・メッセージ表示
    の各章で詳細設計を行う。
* 特に、

  * 「最新のお知らせ」の件数設定（1〜3件）
  * 掲示板フィルタ（ALL / NOTICE / RULES）の扱い
  * HOME 機能タイルと AppFooter の役割分担
    については、本 ch01 を唯一の上位前提として扱い、
    各章が矛盾しないように記載する。

---

**End of Document**
