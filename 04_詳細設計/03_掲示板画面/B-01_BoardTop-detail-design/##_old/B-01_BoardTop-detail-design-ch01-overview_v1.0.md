# B-01 BoardTop 詳細設計書 ch01 概要 v1.0

**Document ID:** HARMONET-COMPONENT-B01-BOARDTOP-DETAIL-CH01
**Version:** 1.0
**Supersedes:** -
**Created:** 2025-11-22
**Updated:** 2025-11-22
**Author:** Tachikoma
**Reviewer:** TKD
**Status:** Draft

---

## 1.1 文書の目的

本章は、HarmoNet 掲示板機能における **掲示板TOP画面コンポーネント BoardTop（B-01）** の詳細設計全体に共通する前提・目的・スコープ・関連ドキュメントを整理することを目的とする。
BoardTop は、URL `/board` に対応する画面として、テナント内の掲示板投稿を一覧で閲覧する中核画面であり、タブ・範囲フィルタ・ページネーションを通じて回覧板情報を俯瞰できるようにする。

本章で定義した内容は、以降の ch02〜ch07（画面構造・データモデル・状態管理・UI・結合・テスト）に共通して適用される前提条件となる。

---

## 1.2 対象コンポーネントと役割

### 1.2.1 コンポーネント情報

* コンポーネント ID: **B-01**
* 名称: **BoardTop**（掲示板 TOP 一覧画面）
* 対応 URL: `/board`
* 対象デバイス: スマートフォン優先（レスポンシブ対応）。PC ブラウザでも同一 URL を利用する。

### 1.2.2 役割

BoardTop の主な役割は次の通りとする。

1. ログイン済みユーザの `tenant_id` に紐づく掲示板投稿を、タブ（ALL / NOTICE / RULES 等）と範囲（GLOBAL / GROUP 等）の組み合わせで一覧表示する。
2. HOME 画面から遷移してきたユーザに対して、「いまテナント内でどのようなお知らせ・回覧が出ているか」を一目で把握できる一覧ビューを提供する。
3. 各投稿のタイトル・カテゴリ・メタ情報（投稿者種別・投稿日・回覧ステータス等）・本文サマリをカード形式で表示し、詳細画面 `/board/[id]` への入口を提供する。
4. 取得エラーや該当データなしの場合に、利用者が状況を理解できるメッセージ（空状態・エラー状態）と適切な再操作手段（再読み込み）を提示する。

翻訳（Google Translate）や音声読み上げ（TTS）については、BoardTop では「サマリ上に翻訳済みテキストや TTS トリガを直接持たない」方針とし、本文の翻訳／TTS は詳細画面（B-02）側で扱う。BoardTop では、翻訳済みキャッシュ有無などを表示上のアイコンで示すかどうかを、基本設計の方針に従って最小限で扱う（必要な場合のみ第5章 UI 仕様で定義する）。

---

## 1.3 スコープ

### 1.3.1 本詳細設計で扱う範囲

本詳細設計（B-01 BoardTop）は、掲示板 TOP 一覧画面に固有の仕様を対象とし、次の内容を含む。

* `/board` 画面のレイアウト構造およびコンポーネント構成（ch02）
* Supabase から取得する投稿一覧データの入出力仕様・ソート条件・フィルタ条件（ch03）
* タブ切替・範囲切替・ページング・カードタップなどの状態管理とイベント遷移（ch04）
* 投稿サマリカードの UI 構造、表示項目、アイコン、静的文言の i18n キー、および空状態・エラー状態のメッセージ仕様（ch05）
* AppHeader / AppFooter / LanguageSwitch / StaticI18nProvider 等の共通部品との結合関係および HOME / 詳細画面との遷移関係（ch06）
* BoardTop 単体および簡易結合テストにおけるテスト観点・UT/IT 方針・主要テストケース一覧（ch07）

### 1.3.2 範囲外とする事項

以下は BoardTop 詳細設計の直接のスコープ外とし、別コンポーネントまたは共通仕様で扱う。

* 掲示板詳細画面 `/board/[id]` の UI・翻訳/TTS ボタン・PDF プレビュー・コメント表示
  → コンポーネント ID: B-02 BoardDetail（別詳細設計書予定）
* 新規投稿・投稿編集フォームの UI・バリデーション・投稿 API 連携
  → コンポーネント ID: B-03 BoardPostForm（別詳細設計書予定）
* Google Translate / Google Cloud TTS を用いた翻訳・音声読み上げ処理の共通設計
  → 共通翻訳/TTS 詳細設計書、および掲示板基本設計 ch06 以降の共通仕様
* 通報・非表示・凍結などのモデレーションロジック、および管理画面からの制御
  → 掲示板モデレーション共通仕様書、管理者画面の詳細設計書
* DB スキーマ定義そのもの（テーブル・カラム・ENUM の定義）
  → `schema.prisma`（唯一の正とし、本詳細設計はこれを参照するのみ）

---

## 1.4 前提条件

BoardTop 詳細設計は、以下の前提条件のもとで成立する。

1. 認証方式

   * HarmoNet 全体の認証方式として、Supabase Auth を利用した MagicLink ログインのみを採用する。
   * BoardTop へのアクセスは、MagicLink による認証が完了し、Supabase セッションが有効なユーザに限定される。
   * 認証未完了時またはセッション失効時の挙動（`/login` へのリダイレクト）は、アプリ全体の共通ルールに従う。

2. テナント・ユーザコンテキスト

   * ログイン完了時点で、フロントエンドは現在の `tenant_id` およびユーザロール（住民・管理組合・その他）が利用可能である。
   * BoardTop は、基本的に「現在の `tenant_id` に紐づく掲示板投稿」のみを対象とし、他テナントの投稿は表示しない。

3. DB スキーマ

   * 掲示板投稿データは、`schema.prisma` で定義された `board_posts` テーブル（および必要に応じて関連テーブル）に格納されている。
   * BoardTop が利用するカラム・ENUM 値は、必ず `schema.prisma` を参照して定義し、スキーマと矛盾する仕様をこの詳細設計に記述しない。

4. パフォーマンス・ページング

   * 非機能要件に基づき、1 ページあたりの表示件数は 20 件を標準とし、ユーザが 10 / 20 / 50 件から選択可能とする方針とする（変更が必要な場合は ch03/ch04 で再定義）。
   * 一覧取得はページング前提であり、全件取得してフロント側でページングする実装は行わない。

5. UI トーン

   * UI トーンは HarmoNet 共通の「やさしい・自然・控えめ」スタイルに従い、白基調・角丸 2xl・控えめなシャドウを基本とする。
   * 本章ではトーンの前提のみを記載し、具体的な Tailwind クラスやコンポーネント構造は ch05 UI 詳細仕様で定義する。

---

## 1.5 関連ドキュメント

BoardTop 詳細設計に関連する上位文書・横断文書を以下に示す。

| 種別     | 名称                                               | 備考                                         |
| ------ | ------------------------------------------------ | ------------------------------------------ |
| 要件定義   | `functional-requirements-all_v1.6.md`            | 掲示板機能（投稿・コメント・回覧板・翻訳・TTS 等）の要件定義。          |
| 非機能要件  | `Nonfunctional-requirements_v1.0.md`             | 認証方式・性能・セキュリティ・運用方針。                       |
| 技術スタック | `harmonet-technical-stack-definition_v4.4.md`    | Next.js / Supabase / Prisma / i18n 等の技術前提。 |
| 基本設計   | `board-design-ch00-index_v2.2.md`                | 掲示板機能 基本設計 目次。                             |
| 基本設計   | `board-design-ch01_v2.2.md`                      | 掲示板機能 全体概要・用語定義。                           |
| 基本設計   | `board-design-ch03_v2.4.md`                      | 掲示板TOP画面（BoardTop）基本設計。                    |
| スキーマ   | `schema.prisma`                                  | `board_posts` など掲示板関連テーブル定義（唯一の正）。         |
| 詳細設計標準 | `harmonet-detail-design-agenda-standard_v1.0.md` | 詳細設計書の章構成・記載粒度標準。                          |

本章で列挙した文書の内容と矛盾する仕様が見つかった場合は、上位文書（要件定義・基本設計・schema.prisma）を優先し、本詳細設計を修正する。
